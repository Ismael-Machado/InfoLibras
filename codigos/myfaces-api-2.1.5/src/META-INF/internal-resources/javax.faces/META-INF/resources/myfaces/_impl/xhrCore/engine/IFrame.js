_MF_CLS(_PFX_XHR+"engine.IFrame",myfaces._impl.xhrCore.engine.BaseRequest,{_frame:null,_requestHeader:null,_aborted:false,CLS_NAME:"myfaces._impl.xhrCore._IFrameRequest",_FRAME_ID:"_mf_comm_frm",constructor_:function(A){this._callSuper("constructor",A);this._initDefaultFinalizableFields();this._requestHeader={};this._XHRConst=myfaces._impl.xhrCore.engine.XhrConst;this._Lang.applyArgs(this,A);this.readyState=this._XHRConst.READY_STATE_UNSENT;},setRequestHeader:function(A,B){this._requestHeader[A]=B;},open:function(F,A,C){this.readyState=this._XHRConst.READY_STATE_OPENED;var E=myfaces._impl.core._Runtime;var B=this._Lang;this._frame=this._createTransportFrame();if(!E.browser.isIE||this._Dom.isDomCompliant()){this._frame.onload=B.hitch(this,this._callback);}else{this._frame.onload_IE=B.hitch(this,this._callback);}this.method=F||this.method;this.url=A||this.url;this.async=("undefined"!=typeof C)?C:this.async;var D={};this._addProgressAttributes(D,10,100);this.onprogress(D);},send:function(E){var C={};this._addProgressAttributes(C,20,100);this.onloadstart(C);this.onprogress(C);var D=E.form.target;var G=E.form.method;var B=E.form.action;var F=E.form;try{for(var A in this._requestHeader){E.append(A,this._requestHeader[A]);}E.form.target=this._frame.name;E.form.method=this.method;if(this.url){E.form.action=this.url;}this.readyState=this._XHRConst.READY_STATE_LOADING;this.onreadystatechange(C);E.form.submit();}finally{E.form.action=B;E.form.target=D;E.form.method=G;E._finalize();}},abort:function(){this._aborted=true;this.onabort({});},_addProgressAttributes:function(A,C,B){A.lengthComputable=true;A.loaded=C;A.total=B;},_callback:function(){if(this._aborted){return ;}try{var A={};this._addProgressAttributes(A,100,100);this.readyState=this._XHRConst.READY_STATE_DONE;this.onreadystatechange(A);this.responseText=this._getFrameText();this.responseXML=this._getFrameXml();this.readyState=this._READY_STATE_DONE;this.onreadystatechange(A);this.onloadend();if(!this._Lang.isXMLParseError(this.responseXML)){this.status=201;this.onload();}else{this.status=0;this.onerror();}}finally{this._frame=null;}},_getFrameDocument:function(){return this._frame.contentWindow.document||this._frame.contentDocument||this._frame.document;},_getFrameText:function(){var B=this._getFrameDocument();var A=B.body||B.documentElement;return A.innerHTML;},_clearFrame:function(){var B=this._getFrameDocument();var A=B.documentElement||B.body;if(myfaces._impl.core._Runtime.browser.isIE){this._Dom._removeChildNodes(A,false);}else{A.innerHTML="";}},_getFrameXml:function(){var A=this._getFrameDocument();return A.XMLDocument||A;},_createTransportFrame:function(){var B=this._FRAME_ID;var D=document.getElementById(B);if(D){return D;}if(this._Dom.isDomCompliant()){D=this._Dom.createElement("iframe",{"src":"about:blank","id":B,"name":B,"type":"content","collapsed":"true","style":"display:none"});document.body.appendChild(D);}else{var C=this._Dom.createElement("div",{"style":"display:none"});C.innerHTML="<iframe id='"+B+"' name='"+B+"' style='display:none;' src='about:blank' type='content' onload='this.onload_IE();'  ></iframe>";var A=document.body;if(A.firstChild){A.insertBefore(C,document.body.firstChild);}else{A.appendChild(C);}}return document.getElementById(B);},_startTimeout:function(){if(this.timeout==0){return ;}this._timeoutTimer=setTimeout(this._Lang.hitch(this,function(){if(this._xhrObject.readyState!=this._XHRConst.READY_STATE_DONE){this._aborted=true;clearTimeout(this._timeoutTimer);this.ontimeout({});this._timeoutTimer=null;}}),this.timeout);}});